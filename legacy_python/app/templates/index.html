<!DOCTYPE html>
<html lang="{{ lang.get('lang_code', 'en') }}" data-bs-theme="auto">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ lang.app_title }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- 导航栏 -->
    {% include 'components/navbar.html' %}
    
    <div class="container-main mt-5">
        <div class="page-header fade-in text-center mb-5">
            <h1 class="display-4 fw-bold mb-3 text-gradient">{{ lang.app_title }}</h1>
            <p class="lead text-muted">{{ lang.intro_text }}</p>
        </div>

        {% if not request.session.get('user') %}
        <!-- 未登录用户的引导 -->
        <div class="row justify-content-center fade-in">
            <div class="col-md-8 col-lg-6">
                <div class="card border-0 shadow-lg text-center p-5">
                    <div class="mb-4 text-primary">
                        <i class="bi bi-cloud-download" style="font-size: 4rem;"></i>
                    </div>
                    <h3 class="mb-3">{{ lang.service_unavailable_message }}</h3>
                    <p class="text-muted mb-4">Please log in to access the download manager and task system.</p>
                    <a href="/login" class="btn btn-primary btn-lg rounded-pill px-5">
                        <i class="bi bi-box-arrow-in-right me-2"></i> {{ lang.login_label if lang.login_label else 'Login Now' }}
                    </a>
                </div>
            </div>
        </div>
        {% else %}
        <!-- 已登录用户的仪表盘 -->
        <div class="row justify-content-center mb-5 fade-in">
            <div class="col-md-10">
                <div class="card border-0 shadow-md bg-gradient-primary-soft">
                    <div class="card-body p-5 text-center">
                        <h2 class="fw-bold mb-4">{{ lang.welcome_back if lang.welcome_back else 'Welcome Back' }}</h2>
                        <div class="d-flex flex-wrap justify-content-center gap-3">
                            <a href="/downloader" class="btn btn-primary btn-lg px-4">
                                <i class="bi bi-plus-lg me-2"></i> {{ lang.start_download_button }}
                            </a>
                            <a href="/tasks" class="btn btn-outline-secondary btn-lg px-4">
                                <i class="bi bi-list-task me-2"></i> {{ lang.job_status_title }}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- 特性部分 -->
        <div class="row g-4 mt-2">
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm fade-in" style="animation-delay: 0.1s">
                    <div class="card-body text-center p-4">
                        <div class="feature-icon bg-primary bg-opacity-10 text-primary rounded-circle mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <i class="bi bi-images fs-3"></i>
                        </div>
                        <h5 class="card-title fw-bold">Gallery Downloader</h5>
                        <p class="card-text text-muted">Seamlessly download image galleries from DeviantArt, Pixiv, and more with gallery-dl integration.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm fade-in" style="animation-delay: 0.2s">
                    <div class="card-body text-center p-4">
                        <div class="feature-icon bg-success bg-opacity-10 text-success rounded-circle mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <i class="bi bi-file-earmark-zip fs-3"></i>
                        </div>
                        <h5 class="card-title fw-bold">Auto Archiving</h5>
                        <p class="card-text text-muted">Automatic compression to .tar.zst ensures efficient storage and faster transfers.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm fade-in" style="animation-delay: 0.3s">
                    <div class="card-body text-center p-4">
                        <div class="feature-icon bg-info bg-opacity-10 text-info rounded-circle mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <i class="bi bi-cloud-upload fs-3"></i>
                        </div>
                        <h5 class="card-title fw-bold">Cloud Sync</h5>
                        <p class="card-text text-muted">Upload directly to S3, Rclone remotes, or other storage providers for safe keeping.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer text-center mt-5 pt-4 text-muted border-top">
            <small>{{ lang.powered_by }} &copy; {{ now_year }}</small>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Auto Dark Mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-bs-theme', 'dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            const newColorScheme = event.matches ? "dark" : "light";
            document.documentElement.setAttribute('data-bs-theme', newColorScheme);
        });
    </script>
</body>
</html>